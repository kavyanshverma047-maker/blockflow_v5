{"openapi":"3.1.0","info":{"title":"Blockflow Exchange (Investor Demo - Fixed)","description":"Wallet, Ledger, Spot, Futures, Margin, Options, Auth, Admin","version":"2.0-Brahmastra"},"paths":{"/admin/fix-alembic":{"get":{"summary":"Fix Alembic","description":"Force Alembic to sync to current migration head.","operationId":"fix_alembic_admin_fix_alembic_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/admin/reset-alembic-version":{"get":{"summary":"Reset Alembic Version","description":"Drop alembic version table for clean slate","operationId":"reset_alembic_version_admin_reset_alembic_version_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/admin/reset-futures-tables":{"get":{"summary":"Reset Futures Tables","description":"Drop old futures tables to rebuild schema","operationId":"reset_futures_tables_admin_reset_futures_tables_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/admin/upgrade-db":{"get":{"summary":"Upgrade Db","description":"Apply Alembic migrations to rebuild dropped tables","operationId":"upgrade_db_admin_upgrade_db_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/wallet/balance/{username}":{"get":{"tags":["wallet"],"summary":"Get Balance","description":"Fetch wallet balance for user or return demo simulated balances.","operationId":"get_balance_api_wallet_balance__username__get","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string","title":"Username"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/wallet/ledger/{username}":{"get":{"tags":["wallet"],"summary":"Get Ledger","description":"Fetch ledger for a given username or return simulated transactions.","operationId":"get_ledger_api_wallet_ledger__username__get","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string","title":"Username"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/register":{"post":{"tags":["auth"],"summary":"Register","operationId":"register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterIn"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login":{"post":{"tags":["auth"],"summary":"Login","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginIn"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/me":{"get":{"tags":["auth"],"summary":"Me","operationId":"me_api_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/auth/apikeys":{"post":{"tags":["auth"],"summary":"Create Api Key","operationId":"create_api_key_api_auth_apikeys_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/api/metrics/":{"get":{"tags":["Metrics"],"summary":"Get Metrics","description":"Returns live system metrics simulated by the background telemetry engine.","operationId":"get_metrics_api_api_metrics__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/api/regulator":{"get":{"tags":["Compliance"],"summary":"Regulator Dashboard","operationId":"regulator_dashboard_api_api_regulator_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/api/infrastructure":{"get":{"tags":["Compliance"],"summary":"Infrastructure","operationId":"infrastructure_api_api_infrastructure_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/health":{"get":{"tags":["Admin"],"summary":"Admin Health","description":"Simple health check for admin router","operationId":"admin_health_api_admin_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/stats":{"get":{"tags":["Admin"],"summary":"Get Admin Stats","description":"Aggregate system-wide trade and user statistics","operationId":"get_admin_stats_api_admin_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/seed-status":{"get":{"tags":["Admin"],"summary":"Seed Status","description":"Check if demo or live data is seeded in DB","operationId":"seed_status_api_admin_seed_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/{rest_of_path}":{"options":{"summary":"Preflight Handler","description":"Handle CORS preflight requests","operationId":"preflight_handler__rest_of_path__options","parameters":[{"name":"rest_of_path","in":"path","required":true,"schema":{"type":"string","title":"Rest Of Path"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/p2p/orders":{"get":{"summary":"P2P List","operationId":"p2p_list_p2p_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/p2p/create":{"post":{"summary":"P2P Create","operationId":"p2p_create_p2p_create_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/P2PCreateSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/p2p/settle/{order_id}":{"post":{"summary":"P2P Settle","operationId":"p2p_settle_p2p_settle__order_id__post","parameters":[{"name":"order_id","in":"path","required":true,"schema":{"type":"integer","title":"Order Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/spot/trade":{"post":{"summary":"Spot Trade","operationId":"spot_trade_spot_trade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpotPlaceSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/spot/orders":{"get":{"summary":"Spot Orders","operationId":"spot_orders_spot_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/trades":{"get":{"summary":"Get Trades","description":"Get recent trades, optionally filtered by symbol","operationId":"get_trades_api_trades_get","parameters":[{"name":"symbol","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Symbol"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":200,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/market/orderbook":{"get":{"summary":"Get Orderbook","description":"Get orderbook with bids/asks, filtered by symbol","operationId":"get_orderbook_api_market_orderbook_get","parameters":[{"name":"symbol","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Symbol"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/leaderboard":{"get":{"summary":"Get Leaderboard","description":"Get top traders by PnL","operationId":"get_leaderboard_api_leaderboard_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/positions":{"get":{"summary":"Get Positions","description":"Get active positions for a user","operationId":"get_positions_api_positions_get","parameters":[{"name":"username","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"demo_trader_0","title":"Username"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/margin/trade":{"post":{"summary":"Margin Trade","operationId":"margin_trade_margin_trade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpotPlaceSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/margin/orders":{"get":{"summary":"Margin Orders","operationId":"margin_orders_margin_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/futures/usdm/trade":{"post":{"summary":"Futures Usdm Trade","operationId":"futures_usdm_trade_futures_usdm_trade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FuturesPlaceSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/futures/usdm/orders":{"get":{"summary":"Futures Usdm Orders","operationId":"futures_usdm_orders_futures_usdm_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/futures/coinm/trade":{"post":{"summary":"Futures Coinm Trade","operationId":"futures_coinm_trade_futures_coinm_trade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FuturesPlaceSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/futures/coinm/orders":{"get":{"summary":"Futures Coinm Orders","operationId":"futures_coinm_orders_futures_coinm_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/options/trade":{"post":{"summary":"Options Trade","operationId":"options_trade_options_trade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OptionsPlaceSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/options/orders":{"get":{"summary":"Options Orders","operationId":"options_orders_options_orders_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/ledger/summary":{"get":{"summary":"Ledger Summary","operationId":"ledger_summary_api_ledger_summary_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/routes":{"get":{"summary":"List Routes","description":"List all registered routes for debugging","operationId":"list_routes_routes_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"FuturesPlaceSchema":{"properties":{"username":{"type":"string","title":"Username"},"pair":{"type":"string","title":"Pair"},"side":{"type":"string","title":"Side"},"price":{"type":"number","title":"Price"},"amount":{"type":"number","title":"Amount"},"leverage":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Leverage","default":20.0}},"type":"object","required":["username","pair","side","price","amount"],"title":"FuturesPlaceSchema"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginIn":{"properties":{"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"LoginIn"},"OptionsPlaceSchema":{"properties":{"username":{"type":"string","title":"Username"},"pair":{"type":"string","title":"Pair"},"side":{"type":"string","title":"Side"},"strike":{"type":"number","title":"Strike"},"option_type":{"type":"string","title":"Option Type"},"premium":{"type":"number","title":"Premium"},"size":{"type":"number","title":"Size"}},"type":"object","required":["username","pair","side","strike","option_type","premium","size"],"title":"OptionsPlaceSchema"},"P2PCreateSchema":{"properties":{"username":{"type":"string","title":"Username"},"asset":{"type":"string","title":"Asset"},"price":{"type":"number","title":"Price"},"amount":{"type":"number","title":"Amount"},"payment_method":{"type":"string","title":"Payment Method"}},"type":"object","required":["username","asset","price","amount","payment_method"],"title":"P2PCreateSchema"},"RegisterIn":{"properties":{"username":{"type":"string","title":"Username"},"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"RegisterIn"},"SpotPlaceSchema":{"properties":{"username":{"type":"string","title":"Username"},"pair":{"type":"string","title":"Pair"},"side":{"type":"string","title":"Side"},"price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Price"},"amount":{"type":"number","title":"Amount"},"leverage":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Leverage","default":1.0},"tp":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Tp"},"sl":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Sl"}},"type":"object","required":["username","pair","side","amount"],"title":"SpotPlaceSchema"},"TokenOut":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token"},"expires_in":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Expires In"}},"type":"object","required":["access_token"],"title":"TokenOut"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/auth/login"}}}}}}